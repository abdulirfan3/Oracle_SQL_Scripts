SELECT NULL INST, NULL SOURCE, NULL BUFFER_POOL, NULL DR_CONS,
  NULL "QUALITY_%", NULL BUFFER_GETS, NULL DISK_READS, NULL DIRECT_READS
  FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL INST, NULL SOURCE, NULL BUFFER_POOL, NULL DR_CONS,
  NULL "QUALITY_%", NULL BUFFER_GETS, NULL DISK_READS, NULL DIRECT_READS
  FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
SELECT
  TO_CHAR(INST_ID, 990) INST,
  SOURCE,
  BUFFER_POOL,
  DR_CONS,
  TO_CHAR(( BUFFER_GETS - DISK_READS + NVL(DIRECT_READS, 0) ) / BUFFER_GETS * 100, 99990.99) "QUALITY_%",
  TO_CHAR(BUFFER_GETS, 99999999999990) BUFFER_GETS,
  TO_CHAR(DISK_READS, 99999999990) DISK_READS,
  TO_CHAR(DIRECT_READS, 99999999990) DIRECT_READS
FROM
( SELECT
    INST_ID,
    'GV$SYSSTAT' SOURCE,
    'ALL' BUFFER_POOL,
    'NO' DR_CONS,
    SUM(DECODE(NAME, 'session logical reads', VALUE, 0)) BUFFER_GETS,
    SUM(DECODE(NAME, 'physical reads', VALUE, 0)) DISK_READS,
    NULL DIRECT_READS
  FROM
    GV$SYSSTAT
  GROUP BY
    INST_ID
  UNION ALL
  ( SELECT
      INST_ID,
      'GV$SYSSTAT' SOURCE,
      'ALL' BUFFER_POOL,
      'YES' DR_CONS,
      SUM(DECODE(NAME, 'session logical reads', VALUE, 0)) BUFFER_GETS,
      SUM(DECODE(NAME, 'physical reads', VALUE, 0)) DISK_READS,
      SUM(DECODE(NAME, 'physical reads direct', VALUE, 
                       'physical reads direct (lob)', VALUE, 0)) DIRECT_READS
    FROM
      GV$SYSSTAT
    GROUP BY
      INST_ID
  )
  UNION ALL
  ( SELECT
      INST_ID,
      'GV$BUFFER_POOL_STATISTICS' SOURCE,
      NAME BUFFER_POOL,
      'YES' DR_CONS,
      DB_BLOCK_GETS + CONSISTENT_GETS BUFFER_GETS,
      PHYSICAL_READS DISK_READS,
      NULL DIRECT_READS
    FROM
      GV$BUFFER_POOL_STATISTICS /* Bug 6369493 can result in overflows and low qualities, may be fixed in Oracle 12 */
  )
)
ORDER BY
  INST,
  SOURCE,
  BUFFER_POOL,
  DR_CONS
));

SELECT NULL OWNER, NULL TABLE_NAME, NULL COLUMN_NAME, NULL NUM_ROWS,
  NULL LONG_OR_LOB FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL COLUMN_NAME, NULL NUM_ROWS,
  NULL LONG_OR_LOB FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER,
    ' ' EXCLUDE_LOB,
    ' ' EXCLUDE_LONG
  FROM
    DUAL
)
SELECT
  T.OWNER,
  T.TABLE_NAME,
  TC.COLUMN_NAME,
  T.NUM_ROWS,
  DECODE(TC.DATA_TYPE, 
    'CLOB', 'LOB',
    'BLOB', 'LOB',
    'NCLOB', 'LOB',
    'BFILE', 'LOB',
    'LONG', 'LONG',
    'LONG RAW', 'LONG') LONG_OR_LOB
FROM
  BASIS_INFO BI,
  DBA_TABLES T,
  DBA_TAB_COLUMNS TC
WHERE
  T.OWNER LIKE BI.OWNER AND
  T.OWNER = TC.OWNER AND
  T.TABLE_NAME = TC.TABLE_NAME AND
  ( BI.EXCLUDE_LOB = ' ' OR 
    TC.DATA_TYPE NOT IN ( 'CLOB', 'BLOB', 'NCLOB', 'BFILE' )
  ) AND
  ( BI.EXCLUDE_LONG = ' ' OR
    TC.DATA_TYPE NOT IN ( 'LONG', 'LONG RAW') 
  ) AND
  T.LAST_ANALYZED IS NOT NULL AND
  TC.LAST_ANALYZED IS NULL
ORDER BY
  NUM_ROWS DESC,
  OWNER,
  TABLE_NAME,
  COLUMN_NAME
));
